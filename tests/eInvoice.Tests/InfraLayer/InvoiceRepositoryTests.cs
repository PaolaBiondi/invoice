using eInvoice.domain.Models;
using eInvoice.domain.Repositories;
using eInvoice.infra.efc.Infra.Models;
using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Hosting;
using System.Data.SqlTypes;
using System.Text;

namespace eInvoice.Tests.InfraLayer
{
    public class InvoiceRepositoryTests: IAsyncLifetime
    {
        private IHost? _host;

        public async Task InitializeAsync()
        {
            _host = await EinvoiceTestFactory.CreateTestHost();
        }

        public async Task DisposeAsync()
        {
            if (_host is null) return;

            await _host.StopAsync();
            _host?.Dispose();
        }

        [Fact]
        public void  InitializeInvoiceRepository_Success()
        {
            var invoiceRepository = _host?.Services.GetService<IInvoiceRepository>();

            Assert.NotNull(invoiceRepository);
        }

        [Fact]
        public async Task GetAttachments_Fails_WrongAttribute()
        {
            string invoiceId = string.Empty;
            var invoiceRepository = _host?.Services.GetService<IInvoiceRepository>();

            await Assert.ThrowsAsync<ArgumentNullException>(async () => await invoiceRepository!.GetInvoiceAttachmentsAsync(invoiceId));
        }

        [Theory]
        [InlineData("951360")]
        [InlineData("951378")]
        public async Task GetAttachments_Success(string invoiceId)
        {
            var invoiceRepository = _host?.Services.GetService<IInvoiceRepository>();

            var result = await invoiceRepository!.GetInvoiceAttachmentsAsync(invoiceId);
            
            Assert.NotNull(result);
            Assert.True(result.StrBase64 is not null && result.StrBase64.Any(i => i.fileName.Equals(domain.Models.Attachment.GetPdfFileName(invoiceId))));
        }

        [Fact]
        public async Task GetReadyInvoices_DoesNotThrowException()
        {
            var invoiceRepository = _host?.Services.GetService<IInvoiceRepository>();

            var exception = await Record.ExceptionAsync(async () => await invoiceRepository!.GetReadyInvoicesAsync());

            Assert.Null(exception);
        }
        
        [Fact]
        public async Task UpdateInvoiceStatus_Success()
        {
            var invoiceRepository = _host?.Services.GetService<IInvoiceRepository>();
            var updateInvoiceStatus = new UpdateElectronicInvoice
            {
                InvoiceNumber = "998480",
                Ogds = DecodeBytesToString(),
                ElectronicId = 67134289,
                Created = DateTime.Now,
                StatusId = 30,
                Sent = DateTime.Parse("2024-03-14 10:46:12.483")
            };

            var exception = await Record.ExceptionAsync(async () => await invoiceRepository!.UpdateInvoiceStatus(updateInvoiceStatus));
            Assert.Null(exception);
        }

        private byte[] DecodeBytesToString()
        {
            var invoiceMessage = "0x3C3F786D6C2076657273696F6E3D22312E302220656E636F64696E673D227574662D38223F3E0D0A3C4F7574676F696E67496E766F696365734461746120786D6C6E733A7873693D22687474703A2F2F7777772E77332E6F72672F323030312F584D4C536368656D612D696E7374616E63652220786D6C6E733A7873643D22687474703A2F2F7777772E77332E6F72672F323030312F584D4C536368656D612220786D6C6E733D22687474703A2F2F66696E612E68722F65726163756E2F6572702F4F7574676F696E67496E766F69636573446174612F76332E32223E0D0A20203C4865616465723E0D0A202020203C537570706C69657249443E38303330303339353035353C2F537570706C69657249443E0D0A202020203C496E766F696365547970653E313C2F496E766F696365547970653E0D0A20203C2F4865616465723E0D0A20203C4F7574676F696E67496E766F6963653E0D0A202020203C537570706C696572496E766F69636549443E3935313336303C2F537570706C696572496E766F69636549443E0D0A202020203C427579657249443E39323932313039363130333C2F427579657249443E0D0A202020203C496E766F696365456E76656C6F70653E0D0A2020202020203C496E766F69636520786D6C6E733A6362633D2275726E3A6F617369733A6E616D65733A73706563696669636174696F6E3A75626C3A736368656D613A7873643A436F6D6D6F6E4261736963436F6D706F6E656E74732D322220786D6C6E733A7361633D2275726E3A6F617369733A6E616D65733A73706563696669636174696F6E3A75626C3A736368656D613A7873643A5369676E6174757265416767726567617465436F6D706F6E656E74732D322220786D6C6E733A6578743D2275726E3A6F617369733A6E616D65733A73706563696669636174696F6E3A75626C3A736368656D613A7873643A436F6D6D6F6E457874656E73696F6E436F6D706F6E656E74732D322220786D6C6E733A6361633D2275726E3A6F617369733A6E616D65733A73706563696669636174696F6E3A75626C3A736368656D613A7873643A436F6D6D6F6E416767726567617465436F6D706F6E656E74732D322220786D6C6E733A7369673D2275726E3A6F617369733A6E616D65733A73706563696669636174696F6E3A75626C3A736368656D613A7873643A436F6D6D6F6E5369676E6174757265436F6D706F6E656E74732D3222207873693A736368656D614C6F636174696F6E3D2275726E3A6F617369733A6E616D65733A73706563696669636174696F6E3A75626C3A736368656D613A7873643A496E766F6963652D32204852496E766F6963652E7873642220786D6C6E733D2275726E3A6F617369733A6E616D65733A73706563696669636174696F6E3A75626C3A736368656D613A7873643A496E766F6963652D32223E0D0A20202020202020203C6578743A55424C457874656E73696F6E733E0D0A202020202020202020203C6578743A55424C457874656E73696F6E3E0D0A2020202020202020202020203C6362633A49443E4852494E564F494345313C2F6362633A49443E0D0A2020202020202020202020203C6362633A4E616D653E496E766F6963654973737565506C616365446174613C2F6362633A4E616D653E0D0A2020202020202020202020203C6578743A457874656E73696F6E4167656E637949443E4D494E474F52503C2F6578743A457874656E73696F6E4167656E637949443E0D0A2020202020202020202020203C6578743A457874656E73696F6E4167656E63794E616D653E4D494E474F52503C2F6578743A457874656E73696F6E4167656E63794E616D653E0D0A2020202020202020202020203C6578743A457874656E73696F6E4167656E63795552493E4D494E474F52503C2F6578743A457874656E73696F6E4167656E63795552493E0D0A2020202020202020202020203C6578743A457874656E73696F6E5552493E75726E3A696E766F6963653A68723A6973737565706C6163653C2F6578743A457874656E73696F6E5552493E0D0A2020202020202020202020203C6578743A457874656E73696F6E526561736F6E436F64653E4D616E6461746F72794669656C643C2F6578743A457874656E73696F6E526561736F6E436F64653E0D0A2020202020202020202020203C6578743A457874656E73696F6E526561736F6E3E4D6A6573746F20697A646176616E6A61207261C48D756E61207072656D612050726176696C6E696B75206F205044562D753C2F6578743A457874656E73696F6E526561736F6E3E0D0A2020202020202020202020203C6578743A457874656E73696F6E436F6E74656E743E0D0A20202020202020202020202020203C6578743A496E766F6963654973737565506C6163653E52696A656B613C2F6578743A496E766F6963654973737565506C6163653E0D0A2020202020202020202020203C2F6578743A457874656E73696F6E436F6E74656E743E0D0A202020202020202020203C2F6578743A55424C457874656E73696F6E3E0D0A202020202020202020203C6578743A55424C457874656E73696F6E3E0D0A2020202020202020202020203C6362633A49443E4852494E564F494345313C2F6362633A49443E0D0A2020202020202020202020203C6362633A4E616D653E496E766F696365497373756572446174613C2F6362633A4E616D653E0D0A2020202020202020202020203C6578743A457874656E73696F6E4167656E637949443E46494E413C2F6578743A457874656E73696F6E4167656E637949443E0D0A2020202020202020202020203C6578743A457874656E73696F6E4167656E63794E616D653E46494E413C2F6578743A457874656E73696F6E4167656E63794E616D653E0D0A2020202020202020202020203C6578743A457874656E73696F6E4167656E63795552493E46494E413C2F6578743A457874656E73696F6E4167656E63795552493E0D0A2020202020202020202020203C6578743A457874656E73696F6E5552493E75726E3A696E766F6963653A68723A6973737565723C2F6578743A457874656E73696F6E5552493E0D0A2020202020202020202020203C6578743A457874656E73696F6E526561736F6E436F64653E4D616E6461746F72794669656C643C2F6578743A457874656E73696F6E526561736F6E436F64653E0D0A2020202020202020202020203C6578743A457874656E73696F6E526561736F6E3E506F64616369206F20697A6461766174656C6A75207072656D61205A616B6F6E75206F207472676F7661C48D6B696D20647275C5A17476696D613C2F6578743A457874656E73696F6E526561736F6E3E0D0A2020202020202020202020203C6578743A457874656E73696F6E436F6E74656E743E0D0A20202020202020202020202020203C6578743A496E766F6963654973737565723E4475C5A1616E6B61204B6F6EC48D61723C2F6578743A496E766F6963654973737565723E0D0A2020202020202020202020203C2F6578743A457874656E73696F6E436F6E74656E743E0D0A202020202020202020203C2F6578743A55424C457874656E73696F6E3E0D0A20202020202020203C2F6578743A55424C457874656E73696F6E733E0D0A20202020202020203C6362633A55424C56657273696F6E49443E322E313C2F6362633A55424C56657273696F6E49443E0D0A20202020202020203C6362633A437573746F6D697A6174696F6E49443E75726E3A696E766F6963652E68723A75626C2D322E312D637573746F6D697A6174696F6E733A46696E61496E766F6963653C2F6362633A437573746F6D697A6174696F6E49443E0D0A20202020202020203C6362633A50726F66696C6549443E4D6F6A45726163756E496E766F6963653C2F6362633A50726F66696C6549443E0D0A20202020202020203C6362633A49443E3935313336303C2F6362633A49443E0D0A20202020202020203C6362633A436F7079496E64696361746F723E66616C73653C2F6362633A436F7079496E64696361746F723E0D0A20202020202020203C6362633A4973737565446174653E323032342D30332D31333C2F6362633A4973737565446174653E0D0A20202020202020203C6362633A497373756554696D653E30383A32313A30303C2F6362633A497373756554696D653E0D0A20202020202020203C6362633A496E766F69636554797065436F6465206C69737449443D22554E2F454345203130303122206C6973744167656E637949443D223622206C6973745552493D22687474703A2F2F7777772E756E6563652E6F72672F74726164652F756E746469642F643030612F747265642F74726564313030312E68746D223E3338303C2F6362633A496E766F69636554797065436F64653E0D0A20202020202020203C6362633A446F63756D656E7443757272656E6379436F6465206C69737449443D2249534F203432313720416C70686122206C6973744167656E637949443D223522206C6973745552493D22687474703A2F2F646F63732E6F617369732D6F70656E2E6F72672F75626C2F6F732D55424C2D322E312F636C2F67632F64656661756C742F43757272656E6379436F64652D322E312E6763223E4555523C2F6362633A446F63756D656E7443757272656E6379436F64653E0D0A20202020202020203C6361633A4163636F756E74696E67537570706C69657250617274793E0D0A202020202020202020203C6361633A50617274793E0D0A2020202020202020202020203C6361633A50617274794E616D653E0D0A20202020202020202020202020203C6362633A4E616D653E4A616472616E736B6120567261746120642E642E3C2F6362633A4E616D653E0D0A2020202020202020202020203C2F6361633A50617274794E616D653E0D0A2020202020202020202020203C6361633A506F7374616C416464726573733E0D0A20202020202020202020202020203C6362633A5374726565744E616D653E4272616A646963613C2F6362633A5374726565744E616D653E0D0A20202020202020202020202020203C6362633A4275696C64696E674E756D6265723E31363C2F6362633A4275696C64696E674E756D6265723E0D0A20202020202020202020202020203C6362633A436974794E616D653E52696A656B613C2F6362633A436974794E616D653E0D0A20202020202020202020202020203C6362633A506F7374616C5A6F6E653E35313030303C2F6362633A506F7374616C5A6F6E653E0D0A20202020202020202020202020203C6361633A416464726573734C696E653E0D0A202020202020202020202020202020203C6362633A4C696E653E4272616A646963612031362C2035313030302052696A656B613C2F6362633A4C696E653E0D0A20202020202020202020202020203C2F6361633A416464726573734C696E653E0D0A20202020202020202020202020203C6361633A436F756E7472793E0D0A202020202020202020202020202020203C6362633A4964656E74696669636174696F6E436F6465206C69737449443D2249534F333136362D3122206C6973744167656E637949443D223622206C6973744E616D653D22436F756E74727922206C69737456657273696F6E49443D22302E3322206C6973745552493D22687474703A2F2F646F63732E6F617369732D6F70656E2E6F72672F75626C2F6F732D75626C2D322E302F636C2F67632F64656661756C742F436F756E7472794964656E74696669636174696F6E436F64652D322E302E676322206C697374536368656D655552493D2275726E3A6F617369733A6E616D65733A73706563696669636174696F6E3A75626C3A636F64656C6973743A67633A436F756E7472794964656E74696669636174696F6E436F64652D322E30223E48523C2F6362633A4964656E74696669636174696F6E436F64653E0D0A202020202020202020202020202020203C6362633A4E616D65202F3E0D0A20202020202020202020202020203C2F6361633A436F756E7472793E0D0A2020202020202020202020203C2F6361633A506F7374616C416464726573733E0D0A2020202020202020202020203C6361633A50617274794C6567616C456E746974793E0D0A20202020202020202020202020203C6362633A526567697374726174696F6E4E616D653E4A616472616E736B6120567261746120642E642E3C2F6362633A526567697374726174696F6E4E616D653E0D0A20202020202020202020202020203C6362633A436F6D70616E7949443E38303330303339353035353C2F6362633A436F6D70616E7949443E0D0A2020202020202020202020203C2F6361633A50617274794C6567616C456E746974793E0D0A202020202020202020203C2F6361633A50617274793E0D0A202020202020202020203C6361633A4163636F756E74696E67436F6E746163743E0D0A2020202020202020202020203C6362633A4E616D653E4475C5A1616E6B61204B6F6EC48D61723C2F6362633A4E616D653E0D0A2020202020202020202020203C6362633A456C656374726F6E69634D61696C3E4147435466696E616E63654069637473692E68723C2F6362633A456C656374726F6E69634D61696C3E0D0A202020202020202020203C2F6361633A4163636F756E74696E67436F6E746163743E0D0A20202020202020203C2F6361633A4163636F756E74696E67537570706C69657250617274793E0D0A20202020202020203C6361633A4163636F756E74696E67437573746F6D657250617274793E0D0A202020202020202020203C6361633A50617274793E0D0A2020202020202020202020203C6361633A50617274794E616D653E0D0A20202020202020202020202020203C6362633A4E616D653E5072696D61636FC5A170656420642E6F2E6F2E3C2F6362633A4E616D653E0D0A2020202020202020202020203C2F6361633A50617274794E616D653E0D0A2020202020202020202020203C6361633A506F7374616C416464726573733E0D0A20202020202020202020202020203C6362633A5374726565744E616D653E4A616E6B6F6D69723C2F6362633A5374726565744E616D653E0D0A20202020202020202020202020203C6362633A4275696C64696E674E756D6265723E32353C2F6362633A4275696C64696E674E756D6265723E0D0A20202020202020202020202020203C6362633A436974794E616D653E5A61677265623C2F6362633A436974794E616D653E0D0A20202020202020202020202020203C6362633A506F7374616C5A6F6E653E31303030303C2F6362633A506F7374616C5A6F6E653E0D0A20202020202020202020202020203C6361633A416464726573734C696E653E0D0A202020202020202020202020202020203C6362633A4C696E653E4A616E6B6F6D69722032352C203130303030205A61677265623C2F6362633A4C696E653E0D0A20202020202020202020202020203C2F6361633A416464726573734C696E653E0D0A20202020202020202020202020203C6361633A436F756E7472793E0D0A202020202020202020202020202020203C6362633A4964656E74696669636174696F6E436F6465206C69737449443D2249534F333136362D3122206C6973744167656E637949443D223622206C6973744E616D653D22436F756E74727922206C69737456657273696F6E49443D22302E3322206C6973745552493D22687474703A2F2F646F63732E6F617369732D6F70656E2E6F72672F75626C2F6F732D75626C2D322E302F636C2F67632F64656661756C742F436F756E7472794964656E74696669636174696F6E436F64652D322E302E676322206C697374536368656D655552493D2275726E3A6F617369733A6E616D65733A73706563696669636174696F6E3A75626C3A636F64656C6973743A67633A436F756E7472794964656E74696669636174696F6E436F64652D322E30223E48523C2F6362633A4964656E74696669636174696F6E436F64653E0D0A202020202020202020202020202020203C6362633A4E616D65202F3E0D0A20202020202020202020202020203C2F6361633A436F756E7472793E0D0A2020202020202020202020203C2F6361633A506F7374616C416464726573733E0D0A2020202020202020202020203C6361633A50617274794C6567616C456E746974793E0D0A20202020202020202020202020203C6362633A526567697374726174696F6E4E616D653E5072696D61636FC5A170656420642E6F2E6F2E3C2F6362633A526567697374726174696F6E4E616D653E0D0A20202020202020202020202020203C6362633A436F6D70616E7949443E39323932313039363130333C2F6362633A436F6D70616E7949443E0D0A2020202020202020202020203C2F6361633A50617274794C6567616C456E746974793E0D0A202020202020202020203C2F6361633A50617274793E0D0A202020202020202020203C6361633A4163636F756E74696E67436F6E746163743E0D0A2020202020202020202020203C6362633A456C656374726F6E69634D61696C3E72696A656B61407072696D61636F2E65753C2F6362633A456C656374726F6E69634D61696C3E0D0A202020202020202020203C2F6361633A4163636F756E74696E67436F6E746163743E0D0A20202020202020203C2F6361633A4163636F756E74696E67437573746F6D657250617274793E0D0A20202020202020203C6361633A44656C69766572793E0D0A202020202020202020203C6362633A41637475616C44656C6976657279446174653E323032342D30332D31343C2F6362633A41637475616C44656C6976657279446174653E0D0A202020202020202020203C6361633A44656C697665727950617274793E0D0A2020202020202020202020203C6361633A50617274794E616D653E0D0A20202020202020202020202020203C6362633A4E616D653E5072696D61636FC5A170656420642E6F2E6F2E3C2F6362633A4E616D653E0D0A20202020202020202020202020203C6362633A436F6D70616E7949443E303034303030303037303C2F6362633A436F6D70616E7949443E0D0A2020202020202020202020203C2F6361633A50617274794E616D653E0D0A2020202020202020202020203C6361633A506F7374616C416464726573733E0D0A20202020202020202020202020203C6362633A5374726565744E616D653E4A616E6B6F6D69722032353C2F6362633A5374726565744E616D653E0D0A20202020202020202020202020203C6362633A436974794E616D653E5A61677265623C2F6362633A436974794E616D653E0D0A20202020202020202020202020203C6362633A506F7374616C5A6F6E653E31303039303C2F6362633A506F7374616C5A6F6E653E0D0A20202020202020202020202020203C6361633A416464726573734C696E653E0D0A202020202020202020202020202020203C6362633A4C696E653E4A616E6B6F6D6972203235202C203130303930205A61677265623C2F6362633A4C696E653E0D0A20202020202020202020202020203C2F6361633A416464726573734C696E653E0D0A20202020202020202020202020203C6361633A436F756E7472793E0D0A202020202020202020202020202020203C6362633A4964656E74696669636174696F6E436F6465206C69737449443D2249534F333136362D3122206C6973744167656E637949443D223622206C6973744E616D653D22436F756E74727922206C69737456657273696F6E49443D22302E3322206C6973745552493D22687474703A2F2F646F63732E6F617369732D6F70656E2E6F72672F75626C2F6F732D75626C2D322E302F636C2F67632F64656661756C742F436F756E7472794964656E74696669636174696F6E436F64652D322E302E676322206C697374536368656D655552493D2275726E3A6F617369733A6E616D65733A73706563696669636174696F6E3A75626C3A636F64656C6973743A67633A436F756E7472794964656E74696669636174696F6E436F64652D322E30223E48523C2F6362633A4964656E74696669636174696F6E436F64653E0D0A202020202020202020202020202020203C6362633A4E616D65202F3E0D0A20202020202020202020202020203C2F6361633A436F756E7472793E0D0A2020202020202020202020203C2F6361633A506F7374616C416464726573733E0D0A2020202020202020202020203C6361633A50617274794C6567616C456E746974793E0D0A20202020202020202020202020203C6362633A526567697374726174696F6E4E616D653E5072696D61636FC5A170656420642E6F2E6F2E3C2F6362633A526567697374726174696F6E4E616D653E0D0A20202020202020202020202020203C6362633A436F6D70616E7949443E303034303030303037303C2F6362633A436F6D70616E7949443E0D0A2020202020202020202020203C2F6361633A50617274794C6567616C456E746974793E0D0A202020202020202020203C2F6361633A44656C697665727950617274793E0D0A202020202020202020203C6361633A4163636F756E74696E67436F6E74616374202F3E0D0A20202020202020203C2F6361633A44656C69766572793E0D0A20202020202020203C6361633A5061796D656E744D65616E733E0D0A202020202020202020203C6362633A5061796D656E744D65616E73436F6465206C69737449443D22554E2F454345203434363122206C6973744167656E637949443D223622206C6973744E616D653D225061796D656E744D65616E73436F646522206C69737456657273696F6E49443D224431304222206C6973745552493D22687474703A2F2F646F63732E6F617369732D6F70656E2E6F72672F75626C2F6F732D55424C2D322E312F636C2F67632F64656661756C742F5061796D656E744D65616E73436F64652D322E312E676322206C697374536368656D655552493D2275726E3A756E3A756E6563653A756E6365666163743A636F64656C6973743A7374616E646172643A554E4543453A5061796D656E744D65616E73436F64653A44313042223E34323C2F6362633A5061796D656E744D65616E73436F64653E0D0A202020202020202020203C6362633A5061796D656E74447565446174653E323032342D30342D30323C2F6362633A5061796D656E74447565446174653E0D0A202020202020202020203C6362633A5061796D656E744368616E6E656C436F6465206C6973744167656E63794E616D653D2243454E2F424949223E4942414E3C2F6362633A5061796D656E744368616E6E656C436F64653E0D0A202020202020202020203C6362633A496E737472756374696F6E49443E3935313336303C2F6362633A496E737472756374696F6E49443E0D0A202020202020202020203C6362633A496E737472756374696F6E4E6F74653E506C61C487616E6A6520706F207261C48D756E753C2F6362633A496E737472756374696F6E4E6F74653E0D0A202020202020202020203C6362633A5061796D656E7449443E485239393C2F6362633A5061796D656E7449443E0D0A202020202020202020203C6361633A506179656546696E616E6369616C4163636F756E743E0D0A2020202020202020202020203C6362633A49443E4852333132343834303038313130353739313534363C2F6362633A49443E0D0A2020202020202020202020203C6362633A43757272656E6379436F6465206C69737449443D2249534F203432313720416C70686122206C6973744167656E637949443D223522206C6973745552493D22687474703A2F2F646F63732E6F617369732D6F70656E2E6F72672F75626C2F6F732D55424C2D322E312F636C2F67632F64656661756C742F43757272656E6379436F64652D322E312E6763223E4555523C2F6362633A43757272656E6379436F64653E0D0A202020202020202020203C2F6361633A506179656546696E616E6369616C4163636F756E743E0D0A20202020202020203C2F6361633A5061796D656E744D65616E733E0D0A20202020202020203C6361633A5061796D656E745465726D733E0D0A202020202020202020203C6362633A507265706169645061796D656E745265666572656E63654944202F3E0D0A202020202020202020203C6362633A416D6F756E742063757272656E637949443D22455552223E3731362E30303C2F6362633A416D6F756E743E0D0A20202020202020203C2F6361633A5061796D656E745465726D733E0D0A20202020202020203C6361633A546178546F74616C3E0D0A202020202020202020203C6362633A546178416D6F756E742063757272656E637949443D22455552223E302E30303C2F6362633A546178416D6F756E743E0D0A202020202020202020203C6361633A546178537562746F74616C3E0D0A2020202020202020202020203C6362633A54617861626C65416D6F756E742063757272656E637949443D22455552223E3731362E30303C2F6362633A54617861626C65416D6F756E743E0D0A2020202020202020202020203C6362633A546178416D6F756E742063757272656E637949443D22455552223E302E30303C2F6362633A546178416D6F756E743E0D0A2020202020202020202020203C6361633A54617843617465676F72793E0D0A20202020202020202020202020203C6362633A494420736368656D6549443D22554E2F45434520353330352220736368656D654167656E637949443D22362220736368656D655552493D22687474703A2F2F7777772E756E6563652E6F72672F74726164652F756E746469642F643037612F747265642F74726564353330352E68746D223E453C2F6362633A49443E0D0A20202020202020202020202020203C6362633A4E616D653E4F534C4F424FC490454E4F5F504F52455A413C2F6362633A4E616D653E0D0A20202020202020202020202020203C6362633A50657263656E743E303C2F6362633A50657263656E743E0D0A20202020202020202020202020203C6362633A5461784578656D7074696F6E526561736F6E3E4F736C6F626FC491656E6F2074656D656C6A656D20C48C6C2E34372E2073742E312E205A616B6F6E61206F205044562D75206920C48C6C2E3131362E2073742E332E2050726176696C6E696B61206F205044562D753C2F6362633A5461784578656D7074696F6E526561736F6E3E0D0A20202020202020202020202020203C6361633A546178536368656D653E0D0A202020202020202020202020202020203C6362633A4E616D653E4652453C2F6362633A4E616D653E0D0A202020202020202020202020202020203C6362633A54617854797065436F64653E5A65726F52617465643C2F6362633A54617854797065436F64653E0D0A20202020202020202020202020203C2F6361633A546178536368656D653E0D0A2020202020202020202020203C2F6361633A54617843617465676F72793E0D0A202020202020202020203C2F6361633A546178537562746F74616C3E0D0A20202020202020203C2F6361633A546178546F74616C3E0D0A20202020202020203C6361633A4C6567616C4D6F6E6574617279546F74616C3E0D0A202020202020202020203C6362633A4C696E65457874656E73696F6E416D6F756E742063757272656E637949443D22455552223E3731362E30303C2F6362633A4C696E65457874656E73696F6E416D6F756E743E0D0A202020202020202020203C6362633A5461784578636C7573697665416D6F756E742063757272656E637949443D22455552223E3731362E30303C2F6362633A5461784578636C7573697665416D6F756E743E0D0A202020202020202020203C6362633A546178496E636C7573697665416D6F756E742063757272656E637949443D22455552223E3731362E30303C2F6362633A546178496E636C7573697665416D6F756E743E0D0A202020202020202020203C6362633A416C6C6F77616E6365546F74616C416D6F756E742063757272656E637949443D22455552223E303C2F6362633A416C6C6F77616E6365546F74616C416D6F756E743E0D0A202020202020202020203C6362633A50617961626C65416D6F756E742063757272656E637949443D22455552223E3731362E30303C2F6362633A50617961626C65416D6F756E743E0D0A20202020202020203C2F6361633A4C6567616C4D6F6E6574617279546F74616C3E0D0A20202020202020203C6361633A496E766F6963654C696E653E0D0A202020202020202020203C6362633A49443E313C2F6362633A49443E0D0A202020202020202020203C6362633A496E766F696365645175616E7469747920756E6974436F64653D224855522220756E6974436F64654C69737449443D22554E2F454345207265632032302038652220756E6974436F64654C6973744167656E637949443D2236223E31302E30303C2F6362633A496E766F696365645175616E746974793E0D0A202020202020202020203C6362633A4C696E65457874656E73696F6E416D6F756E742063757272656E637949443D22455552223E3439302E30303C2F6362633A4C696E65457874656E73696F6E416D6F756E743E0D0A202020202020202020203C6361633A546178546F74616C3E0D0A2020202020202020202020203C6362633A546178416D6F756E742063757272656E637949443D22455552223E302E30303C2F6362633A546178416D6F756E743E0D0A2020202020202020202020203C6361633A546178537562746F74616C3E0D0A20202020202020202020202020203C6362633A54617861626C65416D6F756E742063757272656E637949443D22455552223E303C2F6362633A54617861626C65416D6F756E743E0D0A20202020202020202020202020203C6362633A546178416D6F756E742063757272656E637949443D22455552223E302E30303C2F6362633A546178416D6F756E743E0D0A20202020202020202020202020203C6361633A54617843617465676F72793E0D0A202020202020202020202020202020203C6362633A494420736368656D6549443D22554E2F45434520353330352220736368656D654167656E637949443D22362220736368656D655552493D22687474703A2F2F7777772E756E6563652E6F72672F74726164652F756E746469642F643037612F747265642F74726564353330352E68746D223E453C2F6362633A49443E0D0A202020202020202020202020202020203C6362633A4E616D653E4F534C4F424FC490454E4F5F504F52455A413C2F6362633A4E616D653E0D0A202020202020202020202020202020203C6362633A50657263656E743E302E30303C2F6362633A50657263656E743E0D0A202020202020202020202020202020203C6362633A5461784578656D7074696F6E526561736F6E3E4F736C6F626FC491656E6F2074656D656C6A656D20C48C6C2E34372E2073742E312E205A616B6F6E61206F205044562D75206920C48C6C2E3131362E2073742E332E2050726176696C6E696B61206F205044562D753C2F6362633A5461784578656D7074696F6E526561736F6E3E0D0A202020202020202020202020202020203C6361633A546178536368656D653E0D0A2020202020202020202020202020202020203C6362633A4E616D653E4652453C2F6362633A4E616D653E0D0A2020202020202020202020202020202020203C6362633A54617854797065436F64653E5A65726F52617465643C2F6362633A54617854797065436F64653E0D0A202020202020202020202020202020203C2F6361633A546178536368656D653E0D0A20202020202020202020202020203C2F6361633A54617843617465676F72793E0D0A2020202020202020202020203C2F6361633A546178537562746F74616C3E0D0A202020202020202020203C2F6361633A546178546F74616C3E0D0A202020202020202020203C6361633A4974656D3E0D0A3C6362633A4E616D653E5265656665722064616E69202854617269666131293C2F6362633A4E616D653E3C6361633A53656C6C6572734974656D4964656E74696669636174696F6E3E0D0A3C6362633A49443E3530303030303131383C2F6362633A49443E3C2F6361633A53656C6C6572734974656D4964656E74696669636174696F6E3E3C2F6361633A4974656D3E0D0A202020202020202020203C6361633A50726963653E0D0A2020202020202020202020203C6362633A5072696365416D6F756E742063757272656E637949443D22455552223E34392E30303C2F6362633A5072696365416D6F756E743E0D0A2020202020202020202020203C6362633A426173655175616E7469747920756E6974436F64653D22485552223E313C2F6362633A426173655175616E746974793E0D0A202020202020202020203C2F6361633A50726963653E0D0A20202020202020203C2F6361633A496E766F6963654C696E653E0D0A20202020202020203C6361633A496E766F6963654C696E653E0D0A202020202020202020203C6362633A49443E323C2F6362633A49443E0D0A202020202020202020203C6362633A496E766F696365645175616E7469747920756E6974436F64653D224855522220756E6974436F64654C69737449443D22554E2F454345207265632032302038652220756E6974436F64654C6973744167656E637949443D2236223E322E30303C2F6362633A496E766F696365645175616E746974793E0D0A202020202020202020203C6362633A4C696E65457874656E73696F6E416D6F756E742063757272656E637949443D22455552223E3131322E30303C2F6362633A4C696E65457874656E73696F6E416D6F756E743E0D0A202020202020202020203C6361633A546178546F74616C3E0D0A2020202020202020202020203C6362633A546178416D6F756E742063757272656E637949443D22455552223E302E30303C2F6362633A546178416D6F756E743E0D0A2020202020202020202020203C6361633A546178537562746F74616C3E0D0A20202020202020202020202020203C6362633A54617861626C65416D6F756E742063757272656E637949443D22455552223E303C2F6362633A54617861626C65416D6F756E743E0D0A20202020202020202020202020203C6362633A546178416D6F756E742063757272656E637949443D22455552223E302E30303C2F6362633A546178416D6F756E743E0D0A20202020202020202020202020203C6361633A54617843617465676F72793E0D0A202020202020202020202020202020203C6362633A494420736368656D6549443D22554E2F45434520353330352220736368656D654167656E637949443D22362220736368656D655552493D22687474703A2F2F7777772E756E6563652E6F72672F74726164652F756E746469642F643037612F747265642F74726564353330352E68746D223E453C2F6362633A49443E0D0A202020202020202020202020202020203C6362633A4E616D653E4F534C4F424FC490454E4F5F504F52455A413C2F6362633A4E616D653E0D0A202020202020202020202020202020203C6362633A50657263656E743E302E30303C2F6362633A50657263656E743E0D0A202020202020202020202020202020203C6362633A5461784578656D7074696F6E526561736F6E3E4F736C6F626FC491656E6F2074656D656C6A656D20C48C6C2E34372E2073742E312E205A616B6F6E61206F205044562D75206920C48C6C2E3131362E2073742E332E2050726176696C6E696B61206F205044562D753C2F6362633A5461784578656D7074696F6E526561736F6E3E0D0A202020202020202020202020202020203C6361633A546178536368656D653E0D0A2020202020202020202020202020202020203C6362633A4E616D653E4652453C2F6362633A4E616D653E0D0A2020202020202020202020202020202020203C6362633A54617854797065436F64653E5A65726F52617465643C2F6362633A54617854797065436F64653E0D0A202020202020202020202020202020203C2F6361633A546178536368656D653E0D0A20202020202020202020202020203C2F6361633A54617843617465676F72793E0D0A2020202020202020202020203C2F6361633A546178537562746F74616C3E0D0A202020202020202020203C2F6361633A546178546F74616C3E0D0A202020202020202020203C6361633A4974656D3E0D0A3C6362633A4E616D653E5265656665722064616E6920285461726966612032293C2F6362633A4E616D653E3C6361633A53656C6C6572734974656D4964656E74696669636174696F6E3E0D0A3C6362633A49443E3530303030303131393C2F6362633A49443E3C2F6361633A53656C6C6572734974656D4964656E74696669636174696F6E3E3C2F6361633A4974656D3E0D0A202020202020202020203C6361633A50726963653E0D0A2020202020202020202020203C6362633A5072696365416D6F756E742063757272656E637949443D22455552223E35362E30303C2F6362633A5072696365416D6F756E743E0D0A2020202020202020202020203C6362633A426173655175616E7469747920756E6974436F64653D22485552223E313C2F6362633A426173655175616E746974793E0D0A202020202020202020203C2F6361633A50726963653E0D0A20202020202020203C2F6361633A496E766F6963654C696E653E0D0A20202020202020203C6361633A496E766F6963654C696E653E0D0A202020202020202020203C6362633A49443E333C2F6362633A49443E0D0A202020202020202020203C6362633A496E766F696365645175616E7469747920756E6974436F64653D224855522220756E6974436F64654C69737449443D22554E2F454345207265632032302038652220756E6974436F64654C6973744167656E637949443D2236223E31322E30303C2F6362633A496E766F696365645175616E746974793E0D0A202020202020202020203C6362633A4C696E65457874656E73696F6E416D6F756E742063757272656E637949443D22455552223E3131342E30303C2F6362633A4C696E65457874656E73696F6E416D6F756E743E0D0A202020202020202020203C6361633A546178546F74616C3E0D0A2020202020202020202020203C6362633A546178416D6F756E742063757272656E637949443D22455552223E302E30303C2F6362633A546178416D6F756E743E0D0A2020202020202020202020203C6361633A546178537562746F74616C3E0D0A20202020202020202020202020203C6362633A54617861626C65416D6F756E742063757272656E637949443D22455552223E303C2F6362633A54617861626C65416D6F756E743E0D0A20202020202020202020202020203C6362633A546178416D6F756E742063757272656E637949443D22455552223E302E30303C2F6362633A546178416D6F756E743E0D0A20202020202020202020202020203C6361633A54617843617465676F72793E0D0A202020202020202020202020202020203C6362633A494420736368656D6549443D22554E2F45434520353330352220736368656D654167656E637949443D22362220736368656D655552493D22687474703A2F2F7777772E756E6563652E6F72672F74726164652F756E746469642F643037612F747265642F74726564353330352E68746D223E453C2F6362633A49443E0D0A202020202020202020202020202020203C6362633A4E616D653E4F534C4F424FC490454E4F5F504F52455A413C2F6362633A4E616D653E0D0A202020202020202020202020202020203C6362633A50657263656E743E302E30303C2F6362633A50657263656E743E0D0A202020202020202020202020202020203C6362633A5461784578656D7074696F6E526561736F6E3E4F736C6F626FC491656E6F2074656D656C6A656D20C48C6C2E34372E2073742E312E205A616B6F6E61206F205044562D75206920C48C6C2E3131362E2073742E332E2050726176696C6E696B61206F205044562D753C2F6362633A5461784578656D7074696F6E526561736F6E3E0D0A202020202020202020202020202020203C6361633A546178536368656D653E0D0A2020202020202020202020202020202020203C6362633A4E616D653E4652453C2F6362633A4E616D653E0D0A2020202020202020202020202020202020203C6362633A54617854797065436F64653E5A65726F52617465643C2F6362633A54617854797065436F64653E0D0A202020202020202020202020202020203C2F6361633A546178536368656D653E0D0A20202020202020202020202020203C2F6361633A54617843617465676F72793E0D0A2020202020202020202020203C2F6361633A546178537562746F74616C3E0D0A202020202020202020203C2F6361633A546178546F74616C3E0D0A202020202020202020203C6361633A4974656D3E0D0A3C6362633A4E616D653E456C656B74726F20456E6572676574736B6920446F646174616B202D20667269676F3C2F6362633A4E616D653E3C6361633A53656C6C6572734974656D4964656E74696669636174696F6E3E0D0A3C6362633A49443E3530303030313636343C2F6362633A49443E3C2F6361633A53656C6C6572734974656D4964656E74696669636174696F6E3E3C2F6361633A4974656D3E0D0A202020202020202020203C6361633A50726963653E0D0A2020202020202020202020203C6362633A5072696365416D6F756E742063757272656E637949443D22455552223E392E35303C2F6362633A5072696365416D6F756E743E0D0A2020202020202020202020203C6362633A426173655175616E7469747920756E6974436F64653D22485552223E313C2F6362633A426173655175616E746974793E0D0A202020202020202020203C2F6361633A50726963653E0D0A20202020202020203C2F6361633A496E766F6963654C696E653E0D0A2020202020203C2F496E766F6963653E0D0A202020203C2F496E766F696365456E76656C6F70653E0D0A202020203C4174746163686564446F63756D656E74456E76656C6F70653E0D0A2020202020203C4174746163686564446F63756D656E7420786D6C6E733A6362633D2275726E3A6F617369733A6E616D65733A73706563696669636174696F6E3A75626C3A736368656D613A7873643A436F6D6D6F6E4261736963436F6D706F6E656E74732D322220786D6C6E733A6361633D2275726E3A6F617369733A6E616D65733A73706563696669636174696F6E3A75626C3A736368656D613A7873643A436F6D6D6F6E416767726567617465436F6D706F6E656E74732D3222207873693A736368656D614C6F636174696F6E3D2275726E3A6F617369733A6E616D65733A73706563696669636174696F6E3A75626C3A736368656D613A7873643A4174746163686564446F63756D656E742D322055424C2D4174746163686564446F63756D656E742D322E312E7873642220786D6C6E733D2275726E3A6F617369733A6E616D65733A73706563696669636174696F6E3A75626C3A736368656D613A7873643A4174746163686564446F63756D656E742D32223E0D0A20202020202020203C6362633A49443E3935313336303C2F6362633A49443E0D0A20202020202020203C6362633A4973737565446174653E323032342D30332D31333C2F6362633A4973737565446174653E0D0A20202020202020203C6362633A497373756554696D653E30383A32313A30303C2F6362633A497373756554696D653E0D0A20202020202020203C6362633A506172656E74446F63756D656E7449443E3935313336303C2F6362633A506172656E74446F63756D656E7449443E0D0A20202020202020203C6361633A53656E64657250617274793E0D0A202020202020202020203C6361633A50617274794E616D653E0D0A2020202020202020202020203C6362633A4E616D653E4A616472616E736B6120567261746120642E642E3C2F6362633A4E616D653E0D0A202020202020202020203C2F6361633A50617274794E616D653E0D0A202020202020202020203C6361633A506F7374616C416464726573733E0D0A2020202020202020202020203C6361633A416464726573734C696E653E0D0A20202020202020202020202020203C6362633A4C696E653E4272616A646963612031362C2035313030302052696A656B613C2F6362633A4C696E653E0D0A2020202020202020202020203C2F6361633A416464726573734C696E653E0D0A2020202020202020202020203C6361633A436F756E7472793E0D0A20202020202020202020202020203C6362633A4964656E74696669636174696F6E436F6465206C69737449443D2249534F333136362D3122206C6973744167656E637949443D223622206C6973744E616D653D22436F756E74727922206C69737456657273696F6E49443D22302E3322206C6973745552493D22687474703A2F2F646F63732E6F617369732D6F70656E2E6F72672F75626C2F6F732D75626C2D322E302F636C2F67632F64656661756C742F436F756E7472794964656E74696669636174696F6E436F64652D322E302E676322206C697374536368656D655552493D2275726E3A6F617369733A6E616D65733A73706563696669636174696F6E3A75626C3A636F64656C6973743A67633A436F756E7472794964656E74696669636174696F6E436F64652D322E30223E48523C2F6362633A4964656E74696669636174696F6E436F64653E0D0A20202020202020202020202020203C6362633A4E616D65202F3E0D0A2020202020202020202020203C2F6361633A436F756E7472793E0D0A202020202020202020203C2F6361633A506F7374616C416464726573733E0D0A202020202020202020203C6361633A50617274794C6567616C456E746974793E0D0A2020202020202020202020203C6362633A526567697374726174696F6E4E616D653E4A616472616E736B6120567261746120642E642E3C2F6362633A526567697374726174696F6E4E616D653E0D0A2020202020202020202020203C6362633A436F6D70616E7949443E38303330303339353035353C2F6362633A436F6D70616E7949443E0D0A202020202020202020203C2F6361633A50617274794C6567616C456E746974793E0D0A20202020202020203C2F6361633A53656E64657250617274793E0D0A20202020202020203C6361633A526563656976657250617274793E0D0A202020202020202020203C6361633A50617274794E616D653E0D0A2020202020202020202020203C6362633A4E616D653E5072696D61636FC5A170656420642E6F2E6F2E3C2F6362633A4E616D653E0D0A202020202020202020203C2F6361633A50617274794E616D653E0D0A202020202020202020203C6361633A506F7374616C416464726573733E0D0A2020202020202020202020203C6361633A416464726573734C696E653E0D0A20202020202020202020202020203C6362633A4C696E653E4A616E6B6F6D69722032352C203130303030205A61677265623C2F6362633A4C696E653E0D0A2020202020202020202020203C2F6361633A416464726573734C696E653E0D0A2020202020202020202020203C6361633A436F756E7472793E0D0A20202020202020202020202020203C6362633A4964656E74696669636174696F6E436F6465206C69737449443D2249534F333136362D3122206C6973744167656E637949443D223622206C6973744E616D653D22436F756E74727922206C69737456657273696F6E49443D22302E3322206C6973745552493D22687474703A2F2F646F63732E6F617369732D6F70656E2E6F72672F75626C2F6F732D75626C2D322E302F636C2F67632F64656661756C742F436F756E7472794964656E74696669636174696F6E436F64652D322E302E676322206C697374536368656D655552493D2275726E3A6F617369733A6E616D65733A73706563696669636174696F6E3A75626C3A636F64656C6973743A67633A436F756E7472794964656E74696669636174696F6E436F64652D322E30223E48523C2F6362633A4964656E74696669636174696F6E436F64653E0D0A20202020202020202020202020203C6362633A4E616D65202F3E0D0A2020202020202020202020203C2F6361633A436F756E7472793E0D0A202020202020202020203C2F6361633A506F7374616C416464726573733E0D0A202020202020202020203C6361633A50617274794C6567616C456E746974793E0D0A2020202020202020202020203C6362633A526567697374726174696F6E4E616D653E5072696D61636FC5A170656420642E6F2E6F2E3C2F6362633A526567697374726174696F6E4E616D653E0D0A2020202020202020202020203C6362633A436F6D70616E7949443E39323932313039363130333C2F6362633A436F6D70616E7949443E0D0A202020202020202020203C2F6361633A50617274794C6567616C456E746974793E0D0A20202020202020203C2F6361633A526563656976657250617274793E0D0A20202020202020203C6361633A4174746163686D656E743E0D0A202020202020202020203C6362633A456D626564646564446F63756D656E7442696E6172794F626A656374206D696D65436F64653D226170706C69636174696F6E2F7064662220656E636F64696E67436F64653D22626173653634222066696C656E616D653D22496E766F6963655F3935313336302E706466223E494E564F4943453C2F6362633A456D626564646564446F63756D656E7442696E6172794F626A6563743E0D0A20202020202020203C2F6361633A4174746163686D656E743E0D0A2020202020203C2F4174746163686564446F63756D656E743E0D0A2020202020203C4174746163686564446F63756D656E7420786D6C6E733A6362633D2275726E3A6F617369733A6E616D65733A73706563696669636174696F6E3A75626C3A736368656D613A7873643A436F6D6D6F6E4261736963436F6D706F6E656E74732D322220786D6C6E733A6361633D2275726E3A6F617369733A6E616D65733A73706563696669636174696F6E3A75626C3A736368656D613A7873643A436F6D6D6F6E416767726567617465436F6D706F6E656E74732D3222207873693A736368656D614C6F636174696F6E3D2275726E3A6F617369733A6E616D65733A73706563696669636174696F6E3A75626C3A736368656D613A7873643A4174746163686564446F63756D656E742D322055424C2D4174746163686564446F63756D656E742D322E312E7873642220786D6C6E733D2275726E3A6F617369733A6E616D65733A73706563696669636174696F6E3A75626C3A736368656D613A7873643A4174746163686564446F63756D656E742D32223E0D0A20202020202020203C6362633A49443E3935313336303C2F6362633A49443E0D0A20202020202020203C6362633A4973737565446174653E323032342D30332D31333C2F6362633A4973737565446174653E0D0A20202020202020203C6362633A497373756554696D653E30383A32313A30303C2F6362633A497373756554696D653E0D0A20202020202020203C6362633A506172656E74446F63756D656E7449443E3935313336303C2F6362633A506172656E74446F63756D656E7449443E0D0A20202020202020203C6361633A53656E64657250617274793E0D0A202020202020202020203C6361633A50617274794E616D653E0D0A2020202020202020202020203C6362633A4E616D653E4A616472616E736B6120567261746120642E642E3C2F6362633A4E616D653E0D0A202020202020202020203C2F6361633A50617274794E616D653E0D0A202020202020202020203C6361633A506F7374616C416464726573733E0D0A2020202020202020202020203C6361633A416464726573734C696E653E0D0A20202020202020202020202020203C6362633A4C696E653E4272616A646963612031362C2035313030302052696A656B613C2F6362633A4C696E653E0D0A2020202020202020202020203C2F6361633A416464726573734C696E653E0D0A2020202020202020202020203C6361633A436F756E7472793E0D0A20202020202020202020202020203C6362633A4964656E74696669636174696F6E436F6465206C69737449443D2249534F333136362D3122206C6973744167656E637949443D223622206C6973744E616D653D22436F756E74727922206C69737456657273696F6E49443D22302E3322206C6973745552493D22687474703A2F2F646F63732E6F617369732D6F70656E2E6F72672F75626C2F6F732D75626C2D322E302F636C2F67632F64656661756C742F436F756E7472794964656E74696669636174696F6E436F64652D322E302E676322206C697374536368656D655552493D2275726E3A6F617369733A6E616D65733A73706563696669636174696F6E3A75626C3A636F64656C6973743A67633A436F756E7472794964656E74696669636174696F6E436F64652D322E30223E48523C2F6362633A4964656E74696669636174696F6E436F64653E0D0A20202020202020202020202020203C6362633A4E616D65202F3E0D0A2020202020202020202020203C2F6361633A436F756E7472793E0D0A202020202020202020203C2F6361633A506F7374616C416464726573733E0D0A202020202020202020203C6361633A50617274794C6567616C456E746974793E0D0A2020202020202020202020203C6362633A526567697374726174696F6E4E616D653E4A616472616E736B6120567261746120642E642E3C2F6362633A526567697374726174696F6E4E616D653E0D0A2020202020202020202020203C6362633A436F6D70616E7949443E38303330303339353035353C2F6362633A436F6D70616E7949443E0D0A202020202020202020203C2F6361633A50617274794C6567616C456E746974793E0D0A20202020202020203C2F6361633A53656E64657250617274793E0D0A20202020202020203C6361633A526563656976657250617274793E0D0A202020202020202020203C6361633A50617274794E616D653E0D0A2020202020202020202020203C6362633A4E616D653E5072696D61636FC5A170656420642E6F2E6F2E3C2F6362633A4E616D653E0D0A202020202020202020203C2F6361633A50617274794E616D653E0D0A202020202020202020203C6361633A506F7374616C416464726573733E0D0A2020202020202020202020203C6361633A416464726573734C696E653E0D0A20202020202020202020202020203C6362633A4C696E653E4A616E6B6F6D69722032352C203130303030205A61677265623C2F6362633A4C696E653E0D0A2020202020202020202020203C2F6361633A416464726573734C696E653E0D0A2020202020202020202020203C6361633A436F756E7472793E0D0A20202020202020202020202020203C6362633A4964656E74696669636174696F6E436F6465206C69737449443D2249534F333136362D3122206C6973744167656E637949443D223622206C6973744E616D653D22436F756E74727922206C69737456657273696F6E49443D22302E3322206C6973745552493D22687474703A2F2F646F63732E6F617369732D6F70656E2E6F72672F75626C2F6F732D75626C2D322E302F636C2F67632F64656661756C742F436F756E7472794964656E74696669636174696F6E436F64652D322E302E676322206C697374536368656D655552493D2275726E3A6F617369733A6E616D65733A73706563696669636174696F6E3A75626C3A636F64656C6973743A67633A436F756E7472794964656E74696669636174696F6E436F64652D322E30223E48523C2F6362633A4964656E74696669636174696F6E436F64653E0D0A20202020202020202020202020203C6362633A4E616D65202F3E0D0A2020202020202020202020203C2F6361633A436F756E7472793E0D0A202020202020202020203C2F6361633A506F7374616C416464726573733E0D0A202020202020202020203C6361633A50617274794C6567616C456E746974793E0D0A2020202020202020202020203C6362633A526567697374726174696F6E4E616D653E5072696D61636FC5A170656420642E6F2E6F2E3C2F6362633A526567697374726174696F6E4E616D653E0D0A2020202020202020202020203C6362633A436F6D70616E7949443E39323932313039363130333C2F6362633A436F6D70616E7949443E0D0A202020202020202020203C2F6361633A50617274794C6567616C456E746974793E0D0A20202020202020203C2F6361633A526563656976657250617274793E0D0A20202020202020203C6361633A4174746163686D656E743E0D0A202020202020202020203C6362633A456D626564646564446F63756D656E7442696E6172794F626A656374206D696D65436F64653D226170706C69636174696F6E2F7064662220656E636F64696E67436F64653D22626173653634222066696C656E616D653D224154545F3935313336302E706466223E4154544143484D454E543C2F6362633A456D626564646564446F63756D656E7442696E6172794F626A6563743E0D0A20202020202020203C2F6361633A4174746163686D656E743E0D0A2020202020203C2F4174746163686564446F63756D656E743E0D0A202020203C2F4174746163686564446F63756D656E74456E76656C6F70653E0D0A20203C2F4F7574676F696E67496E766F6963653E0D0A3C2F4F7574676F696E67496E766F69636573446174613E";
            
            // Remove "0x" if present
            if (invoiceMessage.StartsWith("0x", StringComparison.OrdinalIgnoreCase))
                invoiceMessage = invoiceMessage.Substring(2);

            int length = invoiceMessage.Length;
            byte[] bytes = new byte[length / 2];
            for (int i = 0; i < length; i += 2)
                bytes[i / 2] = Convert.ToByte(invoiceMessage.Substring(i, 2), 16);

            return bytes;
        }

        [Theory]
        [InlineData("TW9jayBYTUwgY29udGVudCBmb3IgZmlzY2FsaXphdGlvbiByZXF1ZXN0")]
        public void DecodeFrom64baseStr(string message)
        {
            var decoded = Encoding.UTF8.GetString(Convert.FromBase64String(message));

            Assert.NotNull(decoded);
        }
    }
}
